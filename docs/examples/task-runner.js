(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{1:function(t,e,r){"use strict";function n(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function o(t,e){return{x:t.x*Math.cos(e)-t.y*Math.sin(e),y:t.x*Math.sin(e)+t.y*Math.cos(e)}}function i(t,e){var r=t.velocity.x-e.velocity.x,n=t.velocity.y-e.velocity.y;if(r*(e.x-t.x)+n*(e.y-t.y)<0)return!1;var i=-Math.atan2(e.y-t.y,e.x-t.x),s=t.mass,a=e.mass,u=o(t.velocity,i),c=o(e.velocity,i),p={x:u.x*(s-a)/(s+a)+2*c.x*a/(s+a),y:u.y},h={x:c.x*(s-a)/(s+a)+2*u.x*a/(s+a),y:c.y},y=o(p,-i),f=o(h,-i);return t.velocity.x=y.x,t.velocity.y=y.y,e.velocity.x=f.x,e.velocity.y=f.y,!0}r.d(e,"a",function(){return n}),r.d(e,"b",function(){return i})},5:function(t,e,r){"use strict";function n(t){for(var e=(new Date).getTime();(new Date).getTime()<e+t;);}function o(){var t={};return t.promise=new Promise(function(e,r){t.resolve=e,t.reject=r}),t}r.d(e,"b",function(){return n}),r.d(e,"a",function(){return o})},76:function(t,e,r){"use strict";r.r(e);var n=r(5),o=r(1),i=function(){this.store={},this.front=0,this.end=0},s={size:{configurable:!0}};s.size.get=function(){return this.end-this.front},i.prototype.enqueue=function(t){this.store[this.end]=t,this.end++},i.prototype.dequeue=function(){if(this.front===this.end)return null;var t=this.store[this.front];return delete this.store[this.front],this.front++,t},i.prototype.peek=function(){return 0===this.size()?null:this.store[this.front]},Object.defineProperties(i.prototype,s);var a=i,u={ESSENTIAL:{key:"ESSENTIAL",priority:0},CRITICAL:{key:"CRITICAL",priority:1},NORMAL:{key:"NORMAL",priority:2},IDLE:{key:"IDLE",priority:3}},c=function(t){function e(){var e=this;t.call(this),this._taskPriorities=Object.values(u).sort(function(t,e){return t.priority-e.priority}),this._taskQueueMap=new Map,this._taskPriorities.forEach(function(t){return e._taskQueueMap.set(t.key,new a)}),this._running=!1,requestAnimationFrame(this.run.bind(this))}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={status:{configurable:!0}};return r.status.get=function(){var t=this;return this._taskPriorities.map(function(e){return{priority:e,queue:t._taskQueueMap.get(e.key).size}})},e.prototype.enroll=function(t,e){if(!this._taskQueueMap.has(t.key))throw new Error("This priority is not exist: "+t.key);return this._taskQueueMap.get(t.key).enqueue(e),this.emit("task:enroll",e),e.promise},e.prototype.run=function(t){var e;do{var r=this._getTask();if(!r)break;this._processTask(r),e=window.performance.now()}while(e-t<2);requestAnimationFrame(this.run.bind(this))},e.prototype._getTask=function(){var t=this,e=null;return this._taskPriorities.some(function(r){return!!(e=t._taskQueueMap.get(r.key).dequeue())}),e},e.prototype._processTask=function(t){t.process(),this.emit("task:process")},Object.defineProperties(e.prototype,r),e}(EventEmitter3),p=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var o=Object(n.a)();this._initAction(o,t,e),this.promise=o.promise};p.prototype.process=function(){this.action()},p.prototype._initAction=function(t,e,r){this.action=function(){var n;try{n=e.apply(null,r)}catch(e){t.reject(e)}t.resolve(n)}};var h,y;!function(t){function e(e){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];t.apply(this,[e].concat(r))}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.process=function(){this.action()},e.prototype._initAction=function(t,e,r){this.action=function(){var n;try{n=e.apply(null,r)}catch(e){t.reject(e)}t.resolve(n)}}}(p);!function(){var t=document.getElementById("container"),e=t.clientWidth,r=t.clientHeight,i=document.getElementById("chart"),s=i.getContext("2d");i.width=e,i.height=r;var a=_.throttle(function(){h.data.datasets[0].data=y.status.map(function(t){return t.queue}),h.update()},100);(y=new c).on("task:enroll",a),y.on("task:process",a),h=new Chart(s,{type:"horizontalBar",data:{labels:["ESSENTIAL","CRITICAL","NORMAL","IDLE"],datasets:[{label:"# of tasks",data:y.status.map(function(t){return t.queue}),backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(255, 206, 86, 0.2)","rgba(54, 162, 235, 0.2)","rgba(75, 192, 192, 0.2)"],borderColor:["rgba(255,99,132,1)","rgba(255, 206, 86, 1)","rgba(54, 162, 235, 1)","rgba(75, 192, 192, 1)"],borderWidth:1}]},options:{scales:{xAxes:[{ticks:{beginAtZero:!0}}]}}}),Object.values(u).forEach(function(t){var e=document.getElementById(t.key.toLowerCase());e&&e.addEventListener("click",function(){for(var e=[],r=Object(o.a)(100,1e3),i=0;i<r;i++)e.push(y.enroll(t,new p(function(){Object(n.b)(Object(o.a)(1,4))})));Promise.all(e).then(function(){return console.log(t.key+" finished")})})})}(),window.DEBUG={taskRunner:y}}},[[76,0]]]);
//# sourceMappingURL=task-runner.js.map