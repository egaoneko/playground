(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{47:function(r,t,e){"use strict";e.r(t);var i=function(r,t,e){void 0===r&&(r=0),void 0===t&&(t=0),void 0===e&&(e=0),this.x=r,this.y=t,this.z=e};i.prototype.divide=function(r){if("number"!=typeof r)throw new Error("invalid input: "+r);return this.x/=r,this.y/=r,this.z/=r,this},i.prototype.cross=function(r){var t=this.x,e=this.y,n=this.z;if(!(r instanceof i))throw new Error("invalid input: "+r);this.x=e*r.z-n*r.y,this.y=n*r.x-t*r.z,this.z=t*r.y-e*r.x},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.prototype.normalize=function(){return this.divide(this.length())};var n=i;function a(r,t,e,i){for(var a=(i=Object.assign({},{color:[1,0,0,1],translation:[0,0,0],radius:1,division:30,smoothShading:!0,textured:!1},i)).color,o=i.translation,s=i.radius,u=i.division,f=i.smoothShading,h=i.textured,l=u,m=u,c=[],v=[],g=[],p=[],d=[],x=t.trianglesNormalBuffers,A=t.trianglesColorBuffers,R=t.trianglesVerticeBuffers,B=t.trianglesTexCoordBuffers,y=t.vertexIndexBuffers,E=0;E<=l;E++)for(var b=E*Math.PI/l,F=Math.sin(b),M=Math.cos(b),S=0;S<=m;S++){var _=2*S*Math.PI/m,w=Math.sin(_),T=Math.cos(_)*F,U=M,L=w*F;d.push(.5*(T+1)),d.push(.5*(U+1)),g.push(T),g.push(U),g.push(L),v.push(a[0]),v.push(a[1]),v.push(a[2]),v.push(a[3]),c.push(s*T+o[0]),c.push(s*U+o[1]),c.push(s*L+o[2])}for(var z=0;z<l;z++)for(var C=0;C<m;C++){var I=z*(m+1)+C,N=I+m+1;p.push(I),p.push(N),p.push(I+1),p.push(N),p.push(N+1),p.push(I+1)}if(!f){c=function(r,t){for(var e=[],i=0;i<t.length;++i){var n=3*t[i];e.push(r[n]),e.push(r[n+1]),e.push(r[n+2])}return e}(c,p),v=[];for(var P=0;P<p.length;++P)v.push(a[0]),v.push(a[1]),v.push(a[2]),v.push(a[3]);g=function(r,t){for(var e=[],i=0;i<t.length;i+=3){var a=3*t[i],o=3*t[i+1],s=3*t[i+2],u=new n(r[a],r[a+1],r[a+2]),f=new n(r[o],r[o+1],r[o+2]),h=new n(r[s],r[s+1],r[s+2]),l=(u.x+f.x+h.x)/3,m=(u.y+f.y+h.y)/3,c=(u.z+f.z+h.z)/3,v=new n(l,m,c);e.push(v.x),e.push(v.y),e.push(v.z),e.push(v.x),e.push(v.y),e.push(v.z),e.push(v.x),e.push(v.y),e.push(v.z)}return e}(g,p)}x[e]=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,x[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(g),r.STATIC_DRAW),x[e].itemSize=3,x[e].numItems=g.length/3,A[e]=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,A[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(v),r.STATIC_DRAW),A[e].itemSize=4,A[e].numItems=v.length/4,R[e]=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,R[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(c),r.STATIC_DRAW),R[e].itemSize=3,R[e].numItems=c.length/3,h&&(B[e]=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,B[e]),r.bufferData(r.ARRAY_BUFFER,new Float32Array(d),r.STATIC_DRAW),B[e].itemSize=2,B[e].numItems=d.length/2),y[e]=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,y[e]),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(p),r.STREAM_DRAW),y[e].itemSize=3,y[e].numItems=p.length}var o=null,s=null,u=null,f=null,h=null,l=null,m=null,c=null,v=null,g=[],p=[],d=[],x=[],A=mat4.create(),R=mat4.create(),B=mat3.create(),y=0,E=!1;function b(r,t){var e=o.createShader(t);return o.shaderSource(e,r),o.compileShader(e),o.getShaderParameter(e,o.COMPILE_STATUS)||alert("Error compiling shader: "+o.getShaderInfoLog(e)),e}window.addEventListener("load",function(){s=document.querySelector("#canvas"),u=document.querySelector("#container"),s.width=u.clientWidth,s.height=u.clientHeight;try{o=s.getContext("webgl")||s.getContext("experimental-webgl")}catch(r){console.error(r)}o&&(!function(){var r="\n    attribute vec3 aVertexPosition;\n    attribute vec3 aVertexColor;\n    attribute vec3 aVertexNormal;\n\n    uniform mat4 uPMatrix;    \n    uniform mat4 uMVMatrix;\n    uniform mat3 uNormalMatrix;\n    \n    varying highp vec3 vColor;\n    varying highp vec3 L;\n    varying highp vec3 N;\n    \n    void main(void) {\n      gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n      \n      vec3 pointLightPosition = vec3(1.0, 2.0, -1.0);\n      vec3 pointLightDirection = normalize(vec3(pointLightPosition.xyz - aVertexPosition.xyz));\n      vec3 ambientColor = vec3(0.1, 0.1, 0.1);\n      \n      L = vec3(uPMatrix * uMVMatrix * vec4(pointLightDirection, 1.0));\n      N = uNormalMatrix * aVertexNormal;\n      \n      vColor = aVertexColor;\n    }\n  ",t="\n    varying highp vec3 vColor;\n    varying highp vec3 N;\n    varying highp vec3 L;\n    \n    void main(void) {\n      highp float lambert = max(dot(normalize(N), normalize(L)), 0.0);\n      gl_FragColor = vec4(vColor * lambert, 1.0);\n    }\n  ";l=b(r,o.VERTEX_SHADER),h=b(t,o.FRAGMENT_SHADER),f=o.createProgram(),o.attachShader(f,l),o.attachShader(f,h),o.linkProgram(f),o.getProgramParameter(f,o.LINK_STATUS)||alert("Unable to initialize the shader program.");o.useProgram(f)}(),a(o,{trianglesNormalBuffers:p,trianglesColorBuffers:d,trianglesVerticeBuffers:g,vertexIndexBuffers:x},0,{translation:[-1,-.75,0],color:[1,0,0,1],division:20,smoothShading:!1}),a(o,{trianglesNormalBuffers:p,trianglesColorBuffers:d,trianglesVerticeBuffers:g,vertexIndexBuffers:x},1,{translation:[0,0,1],color:[0,1,0,1],division:10,smoothShading:!1}),a(o,{trianglesNormalBuffers:p,trianglesColorBuffers:d,trianglesVerticeBuffers:g,vertexIndexBuffers:x},2,{translation:[1,.25,-1],color:[1,1,0,1],division:5,smoothShading:!1}),a(o,{trianglesNormalBuffers:p,trianglesColorBuffers:d,trianglesVerticeBuffers:g,vertexIndexBuffers:x},3,{translation:[0,-1,0]}),m=o.getAttribLocation(f,"aVertexPosition"),v=o.getAttribLocation(f,"aVertexColor"),c=o.getAttribLocation(f,"aVertexNormal"),o.enableVertexAttribArray(m),o.enableVertexAttribArray(v),o.enableVertexAttribArray(c),f.pMatrixUniform=o.getUniformLocation(f,"uPMatrix"),f.mvMatrixUniform=o.getUniformLocation(f,"uMVMatrix"),f.normalMatrixUniform=o.getUniformLocation(f,"uNormalMatrix"),function r(){E||(o.clearColor(.7,.7,.7,1),o.clear(o.COLOR_BUFFER_BIT),o.enable(o.DEPTH_TEST),o.viewport(0,0,s.width,s.height),mat4.perspective(A,45,s.width/s.height,.1,100),function(){mat4.identity(R),mat4.translate(R,R,[0,.4,-6.5]),mat4.rotate(R,R,y,[0,1,0]);var r=mat3.create();mat3.fromMat4(r,R),mat3.invert(B,r),mat3.transpose(B,B),y+=.005,o.uniformMatrix4fv(f.pMatrixUniform,!1,A),o.uniformMatrix4fv(f.mvMatrixUniform,!1,R),o.uniformMatrix3fv(f.normalMatrixUniform,!1,B);for(var t=0;t<x.length;++t)o.bindBuffer(o.ARRAY_BUFFER,g[t]),o.vertexAttribPointer(m,3,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,d[t]),o.vertexAttribPointer(v,4,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,p[t]),o.vertexAttribPointer(c,3,o.FLOAT,!1,0,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,x[t]),3===t?o.drawElements(o.TRIANGLES,x[t].numItems,o.UNSIGNED_SHORT,0):o.drawArrays(o.TRIANGLES,0,g[t].numItems)}()),requestAnimationFrame(r)}())}),document.addEventListener("keyup",function(r){switch(r.keyCode){case 80:E=!E}})}},[[47,0]]]);
//# sourceMappingURL=webgl-light.js.map