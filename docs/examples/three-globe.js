(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{43:function(e,n){var t,r,o,a,i,s,c,d=45,l=.1,E=2e3,w=200,h=new THREE.Raycaster,p=new THREE.Vector2;function u(){a=s.clientWidth,i=s.clientHeight,o.aspect=a/i,o.updateProjectionMatrix(),t.setSize(a,i)}function T(e){p.x=e.clientX/window.innerWidth*2-1,p.y=-e.clientY/window.innerHeight*2+1,h.setFromCamera(p,o);for(var n=h.intersectObject(c,!0),t=0;t<n.length;t++)console.log(g(n[t].point))}function f(e){p.x=e.clientX/window.innerWidth*2-1,p.y=-e.clientY/window.innerHeight*2+1,h.setFromCamera(p,o);for(var n=h.intersectObject(c,!0),t=0;t<n.length;t++){var a=new THREE.SphereGeometry(.5),i=new THREE.MeshBasicMaterial({color:"#ff0000"}),s=new THREE.Mesh(a,i);s.position.copy(n[t].point),r.add(s)}}function v(e,n,t){var r=m(90-n),o=m(e+180),a=-t*Math.sin(r)*Math.cos(o),i=t*Math.sin(r)*Math.sin(o),s=t*Math.cos(r);return new THREE.Vector3(a,s,i)}function g(e){e.normalize();var n=(270+H(Math.atan2(e.x,e.z)))%360,t=new THREE.Vector3(e.x,0,e.z);t.normalize();var r=H(Math.acos(t.dot(e)));return e.y<0&&(r*=-1),[n,r]}function m(e){return e*(Math.PI/180)}function H(e){return e*(180/Math.PI)}proj4.defs([["Globe","+proj=longlat +a=6367470 +b=6367470 +ellps=sphere +datum=WGS84 +units=degrees"]]),function(){s=document.getElementById("container"),a=s.clientWidth,i=s.clientHeight,(r=new THREE.Scene({antialias:!0})).background=new THREE.Color(0),r.fog=new THREE.FogExp2(0,3e-4),(o=new THREE.PerspectiveCamera(d,a/i,l,E)).position.set(0,0,1e3);var e=new THREE.PointLight(16777215);e.position.set(10,50,400),r.add(e);var n=w;c=new THREE.Group,r.add(c),(new THREE.TextureLoader).load("data/img/land_ocean_ice_cloud_2048.jpg",function(e){var t=new THREE.SphereGeometry(n,50,50),r=new THREE.MeshBasicMaterial({map:e,overdraw:.5}),o=new THREE.Mesh(t,r);c.add(o)}),c.position.set(0,0,0);for(var h=new THREE.SphereGeometry(1e3,100,50),p=new THREE.PointsMaterial({size:1,transparency:!0,opacity:.7}),g=0;g<45e3;g++){var m=new THREE.Vector3;m.x=2e3*Math.random()-1e3,m.y=2e3*Math.random()-1e3,m.z=2e3*Math.random()-1e3,h.vertices.push(m)}var H=new THREE.Points(h,p);r.add(H),(t=new THREE.WebGLRenderer({alpha:!0,antialias:!0})).setClearColor(268435455,0),t.setPixelRatio(window.devicePixelRatio),t.setSize(a,i),s.appendChild(t.domElement);var R=new THREE.OrbitControls(o,t.domElement);R.screenSpacePanning=!0,R.minDistance=300,R.maxDistance=E,window.addEventListener("resize",u,!1),window.addEventListener("click",T),window.addEventListener("dblclick",f),fetch("data/geojson/capitals.geojson").then(function(e){return e.json()}).then(function(e){var n=e.features.map(function(e){return Object.assign({},e.properties,{coordinates:turf.getCoord(e)})});n.forEach(function(e){var n=e.coordinates,t=n[0],o=n[1],a=new THREE.SphereGeometry(1),i=new THREE.MeshBasicMaterial({color:"#ff0000"}),s=new THREE.Mesh(a,i);s.position.copy(v(t,o,w)),r.add(s);var c=function(e,n){void 0===n&&(n={});var t=n.hasOwnProperty("fontface")?n.fontface:"Arial",r=n.hasOwnProperty("fontsize")?n.fontsize:18,o=n.hasOwnProperty("borderThickness")?n.borderThickness:4,a=n.hasOwnProperty("borderColor")?n.borderColor:{r:0,g:0,b:0,a:1},i=n.hasOwnProperty("backgroundColor")?n.backgroundColor:{r:255,g:255,b:255,a:1},s=n.hasOwnProperty("textColor")?n.textColor:{r:0,g:0,b:0,a:1},c=document.createElement("canvas"),d=c.getContext("2d");d.font="Bold "+r+"px "+t;var l=d.measureText(e).width;d.fillStyle="rgba("+i.r+","+i.g+","+i.b+","+i.a+")",d.strokeStyle="rgba("+a.r+","+a.g+","+a.b+","+a.a+")",d.lineWidth=o,function(e,n,t,r,o,a){e.beginPath(),e.moveTo(n+a,t),e.lineTo(n+r-a,t),e.quadraticCurveTo(n+r,t,n+r,t+a),e.lineTo(n+r,t+o-a),e.quadraticCurveTo(n+r,t+o,n+r-a,t+o),e.lineTo(n+a,t+o),e.quadraticCurveTo(n,t+o,n,t+o-a),e.lineTo(n,t+a),e.quadraticCurveTo(n,t,n+a,t),e.closePath(),e.fill(),e.stroke()}(d,o/2,o/2,1.1*(l+o),1.4*r+o,8),d.fillStyle="rgba("+s.r+", "+s.g+", "+s.b+", 1.0)",d.fillText(e,o,r+o);var E=new THREE.Texture(c);E.needsUpdate=!0;var w=new THREE.SpriteMaterial({map:E,useScreenCoordinates:!1}),h=new THREE.Sprite(w);return h.scale.set(.5*r,.25*r,.75*r),h}(e.city,{fontsize:50});c.position.copy(v(t,o,w+10)),r.add(c)})})}(),function e(){requestAnimationFrame(e);t.render(r,o)}()}},[[43,0]]]);
//# sourceMappingURL=three-globe.js.map