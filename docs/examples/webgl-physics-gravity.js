(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{0:function(e,t,r){"use strict";var n=function(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),this.x=e,this.y=t,this.z=r};n.prototype.divide=function(e){if("number"!=typeof e)throw new Error("invalid input: "+e);return this.x/=e,this.y/=e,this.z/=e,this},n.prototype.cross=function(e){var t=this.x,r=this.y,i=this.z;if(!(e instanceof n))throw new Error("invalid input: "+e);this.x=r*e.z-i*e.y,this.y=i*e.x-t*e.z,this.z=t*e.y-r*e.x},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},n.prototype.normalize=function(){return this.divide(this.length())},t.a=n},2:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return a});var n=r(0);function i(e,t,r,n){for(var i,a,o,s=(n=Object.assign({},{size:10,color:[.5,.5,1,1],translation:[0,0,0],textured:!1},n)).size,u=n.color,f=n.translation,l=n.textured,c=[],h=[],m=t.trianglesNormalBuffers,v=t.trianglesColorBuffers,d=t.trianglesVerticeBuffers,p=t.trianglesTexCoordBuffers,g=t.vertexIndexBuffers,A=0;A<5;++A)c.push(0),c.push(1),c.push(0),h.push(u[0]),h.push(u[1]),h.push(u[2]),h.push(u[3]);i=[0,0,0,-s,0,-s,s,0,-s,s,0,s,-s,0,s],o=[0,0,-s,-s,s,-s,s,s,-s,s];for(var R=0;R<i.length;R+=3)i[R]+=f[0],i[R+1]+=f[1],i[R+2]+=f[2];a=[0,1,2,0,2,3,0,3,4,0,4,1],m[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,m[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(c),e.STATIC_DRAW),m[r].itemSize=3,m[r].numItems=c.length/3,v[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,v[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(h),e.STATIC_DRAW),v[r].itemSize=4,v[r].numItems=h.length/4,d[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,d[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STATIC_DRAW),d[r].itemSize=3,d[r].numItems=i.length/3,l&&(p[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,p[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),p[r].itemSize=2,p[r].numItems=o.length/2),g[r]=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,g[r]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),e.STREAM_DRAW),g[r].itemSize=3,g[r].numItems=a.length}function a(e,t,r,i){for(var a=(i=Object.assign({},{color:[1,0,0,1],translation:[0,0,0],radius:1,division:30,smoothShading:!0,textured:!1},i)).color,o=i.translation,s=i.radius,u=i.division,f=i.smoothShading,l=i.textured,c=u,h=u,m=[],v=[],d=[],p=[],g=[],A=t.trianglesNormalBuffers,R=t.trianglesColorBuffers,x=t.trianglesVerticeBuffers,B=t.trianglesTexCoordBuffers,b=t.vertexIndexBuffers,E=0;E<=c;E++)for(var F=E*Math.PI/c,y=Math.sin(F),w=Math.cos(F),_=0;_<=h;_++){var S=2*_*Math.PI/h,T=Math.sin(S),I=Math.cos(S)*y,M=w,U=T*y;g.push(.5*(I+1)),g.push(.5*(M+1)),d.push(I),d.push(M),d.push(U),v.push(a[0]),v.push(a[1]),v.push(a[2]),v.push(a[3]),m.push(s*I+o[0]),m.push(s*M+o[1]),m.push(s*U+o[2])}for(var L=0;L<c;L++)for(var D=0;D<h;D++){var C=L*(h+1)+D,z=C+h+1;p.push(C),p.push(z),p.push(C+1),p.push(z),p.push(z+1),p.push(C+1)}if(!f){m=function(e,t){for(var r=[],n=0;n<t.length;++n){var i=3*t[n];r.push(e[i]),r.push(e[i+1]),r.push(e[i+2])}return r}(m,p),v=[];for(var N=0;N<p.length;++N)v.push(a[0]),v.push(a[1]),v.push(a[2]),v.push(a[3]);d=function(e,t){for(var r=[],i=0;i<t.length;i+=3){var a=3*t[i],o=3*t[i+1],s=3*t[i+2],u=new n.a(e[a],e[a+1],e[a+2]),f=new n.a(e[o],e[o+1],e[o+2]),l=new n.a(e[s],e[s+1],e[s+2]),c=(u.x+f.x+l.x)/3,h=(u.y+f.y+l.y)/3,m=(u.z+f.z+l.z)/3,v=new n.a(c,h,m);r.push(v.x),r.push(v.y),r.push(v.z),r.push(v.x),r.push(v.y),r.push(v.z),r.push(v.x),r.push(v.y),r.push(v.z)}return r}(d,p)}A[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,A[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(d),e.STATIC_DRAW),A[r].itemSize=3,A[r].numItems=d.length/3,R[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,R[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(v),e.STATIC_DRAW),R[r].itemSize=4,R[r].numItems=v.length/4,x[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,x[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(m),e.STATIC_DRAW),x[r].itemSize=3,x[r].numItems=m.length/3,l&&(B[r]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,B[r]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(g),e.STATIC_DRAW),B[r].itemSize=2,B[r].numItems=g.length/2),b[r]=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,b[r]),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(p),e.STREAM_DRAW),b[r].itemSize=3,b[r].numItems=p.length}},3:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),i=function(e){e=Object.assign({},{radius:1,position:new n.a(0,0,0),velocity:new n.a(0,0,0),acceleration:new n.a(0,0,0)},e),this.radius=e.radius,this.position=e.position,this.velocity=e.velocity,this.acceleration=e.acceleration,this.vboIndex=e.vboIndex}},52:function(e,t,r){"use strict";r.r(t);var n=r(2),i=r(3),a=r(0),o=null,s=null,u=null,f=null,l=null,c=null,h=null,m=null,v=null,d=[],p=[],g=[],A=[],R=mat4.create(),x=mat4.create(),B=mat3.create(),b=!1,E={flat:{vertexShader:"\n    attribute vec3 aVertexPosition;\n    attribute vec3 aVertexColor;\n    attribute vec3 aVertexNormal;\n\n    uniform mat4 uPMatrix;    \n    uniform mat4 uMVMatrix;\n    uniform mat3 uNormalMatrix;\n    \n    varying highp vec3 vColor;\n    varying highp vec3 L;\n    varying highp vec3 N;\n    \n    void main(void) {\n      gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n      \n      vec3 pointLightPosition = vec3(1.0, 2.0, -1.0);\n      vec3 pointLightDirection = normalize(vec3(pointLightPosition.xyz - aVertexPosition.xyz));\n      vec3 ambientColor = vec3(0.1, 0.1, 0.1);\n      \n      L = vec3(uPMatrix * uMVMatrix * vec4(pointLightDirection, 1.0));\n      N = uNormalMatrix * aVertexNormal;\n      \n      vColor = aVertexColor;\n    }\n  ",fragmentShader:"\n    varying highp vec3 vColor;\n    varying highp vec3 N;\n    varying highp vec3 L;\n    \n    void main(void) {\n      highp float lambert = max(dot(normalize(N), normalize(L)), 0.0);\n      gl_FragColor = vec4(vColor * lambert, 1.0);\n    }\n  "}},F=[],y=[],w=1,_=5,S=-1,T=-.8;function I(e,t){var r=o.createShader(t);return o.shaderSource(r,e),o.compileShader(r),o.getShaderParameter(r,o.COMPILE_STATUS)||alert("Error compiling shader: "+o.getShaderInfoLog(r)),r}function M(e,t){for(var r=0;r<e.length;r++)if(e[r].vboIndex===t)return r;return-1}function U(e){var t=F[e];return _-(t.position.y+t.radius)>S}function L(){o.uniformMatrix4fv(f.pMatrixUniform,!1,R),o.uniformMatrix4fv(f.mvMatrixUniform,!1,x),o.uniformMatrix3fv(f.normalMatrixUniform,!1,B)}window.addEventListener("load",function(){s=document.querySelector("#canvas"),u=document.querySelector("#container"),s.width=u.clientWidth,s.height=u.clientHeight,function(){s.addEventListener("mousedown",function(e){!0,y=[e.pageX,e.pageY];var t=function(e){var t=e.pageX-y[0],r=e.pageY-y[1];y[0]=e.pageX,y[1]=e.pageY,t,r},r=function(){document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",r),!1};document.addEventListener("mousemove",t),document.addEventListener("mouseup",r)});var e=function(e){e>0?w+=1:(w-=.1)<.01&&(w=.1)};s.addEventListener("mousewheel",function(t){t.stopPropagation(),t.preventDefault(),e(t.wheelDelta)}),s.addEventListener("DOMMouseScroll",function(t){t.stopPropagation(),t.preventDefault(),e(-.1*t.originalEvent.detail)})}();try{o=s.getContext("webgl")||s.getContext("experimental-webgl")}catch(e){console.error(e)}o&&(!function(e){(function(e,t){var r=E[t].vertexShader,n=E[t].fragmentShader;c=I(r,o.VERTEX_SHADER),l=I(n,o.FRAGMENT_SHADER),o.attachShader(e,c),o.attachShader(e,l),o.linkProgram(e),o.getProgramParameter(e,o.LINK_STATUS)||alert("Unable to initialize the shader program.")})(f=o.createProgram(),e),o.useProgram(f),f.pMatrixUniform=o.getUniformLocation(f,"uPMatrix"),f.mvMatrixUniform=o.getUniformLocation(f,"uMVMatrix"),f.normalMatrixUniform=o.getUniformLocation(f,"uNormalMatrix")}("flat"),Object(n.b)(o,{trianglesNormalBuffers:p,trianglesColorBuffers:g,trianglesVerticeBuffers:d,vertexIndexBuffers:A},0,{color:[1,0,0,1],division:20,smoothShading:!1}),Object(n.b)(o,{trianglesNormalBuffers:p,trianglesColorBuffers:g,trianglesVerticeBuffers:d,vertexIndexBuffers:A},1,{color:[0,1,0,1],division:10,smoothShading:!1}),Object(n.b)(o,{trianglesNormalBuffers:p,trianglesColorBuffers:g,trianglesVerticeBuffers:d,vertexIndexBuffers:A},2,{color:[1,1,0,1],division:5,smoothShading:!1}),Object(n.b)(o,{trianglesNormalBuffers:p,trianglesColorBuffers:g,trianglesVerticeBuffers:d,vertexIndexBuffers:A},3,{color:[1,0,1,1]}),Object(n.b)(o,{trianglesNormalBuffers:p,trianglesColorBuffers:g,trianglesVerticeBuffers:d,vertexIndexBuffers:A},4,{color:[0,1,1,1]}),Object(n.a)(o,{trianglesNormalBuffers:p,trianglesColorBuffers:g,trianglesVerticeBuffers:d,vertexIndexBuffers:A},5,{translation:[0,S,0]}),F.push(new i.a({vboIndex:0,position:new a.a(-1,-.75,0),acceleration:new a.a(0,.01,0)})),F.push(new i.a({vboIndex:1,position:new a.a(0,0,1),acceleration:new a.a(0,.01,0)})),F.push(new i.a({vboIndex:2,position:new a.a(1,.25,-1),acceleration:new a.a(0,.01,0)})),F.push(new i.a({vboIndex:3,position:new a.a(-1,1,-1),acceleration:new a.a(0,.01,0)})),F.push(new i.a({vboIndex:4,position:new a.a(-0,1.75,-0),acceleration:new a.a(0,.01,0)})),h=o.getAttribLocation(f,"aVertexPosition"),v=o.getAttribLocation(f,"aVertexColor"),m=o.getAttribLocation(f,"aVertexNormal"),o.enableVertexAttribArray(h),o.enableVertexAttribArray(v),o.enableVertexAttribArray(m),function e(){b||(o.clearColor(.7,.7,.7,1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.enable(o.DEPTH_TEST),o.viewport(0,0,s.width,s.height),mat4.perspective(R,45,s.width/s.height,.1,100),function(){for(var e=0;e<A.length;++e){mat4.identity(x),mat4.translate(x,x,[0,-1,-15.5]);var t=M(F,e);if(-1!==t){var r=F[t];U(t)?(r.velocity.y+=r.acceleration.y,r.position.y+=r.velocity.y):(r.position.y-=r.velocity.y,r.velocity.y*=T),mat4.translate(x,x,[r.position.x,_-r.position.y,r.position.z])}mat4.scale(x,x,[w,w,w]);var n=mat3.create();mat3.fromMat4(n,x),mat3.invert(B,n),mat3.transpose(B,B),L(),o.bindBuffer(o.ARRAY_BUFFER,d[e]),o.vertexAttribPointer(h,3,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,g[e]),o.vertexAttribPointer(v,4,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,p[e]),o.vertexAttribPointer(m,3,o.FLOAT,!1,0,0),4===e?(o.disable(o.DEPTH_TEST),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE),o.blendEquation(o.FUNC_ADD)):(o.disable(o.BLEND),o.enable(o.DEPTH_TEST)),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,A[e]),e>2?o.drawElements(o.TRIANGLES,A[e].numItems,o.UNSIGNED_SHORT,0):o.drawArrays(o.TRIANGLES,0,d[e].numItems)}}()),requestAnimationFrame(e)}())}),document.addEventListener("keyup",function(e){switch(e.keyCode){case 80:b=!b}})}},[[52,0]]]);
//# sourceMappingURL=webgl-physics-gravity.js.map